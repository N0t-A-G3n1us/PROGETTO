<!DOCTYPE html>
<html>
	<head>
		<meta charset="ISO-8859-1"/>
	
		<style>
			
			input{
				font-size:150%;
				
				}
			button{
				font-size:200%;
				color: blue;
				}
			p{
				font-size:150%;
				}
			
			</style>
	
		<script type = "text/javascript" language="javascript">
			var args=window.location.search.substr(1).toString().split("=");
			var MyNomeUtente = args[1];
			var MyPunteggio = args[2];

			function inizializzaClassificaUtenti(){
				if (typeof(localStorage.utenti) == "undefined") {
					localStorage.utenti="[]";
			}
			}
			
			function resetClassificaUtenti(){
				localStorage.utenti="[]";
			}
			function stampaClassifica(){
				var u = JSON.parse(localStorage.utenti);
				var l = u.length<=10? u.length:10;
				
				var s = new String("<h3>CLASSIFICA ATTUALE:</h3>");
				
				for (i=0;i<l;i++)
					s += JSON.stringify(u[i])+"<br/>";
				
				document.getElementById("vistaStorage").innerHTML=s;
				return true;
			}

			function ordina(u){	//costo O(n^2) per array piccolo
				var l = u.length;
				for(i = 0; i < l-1; i++){
					for(j = l-1; j > i; j--){
						if(u[j-1].score < u[j].score){
							aux = u[j-1];
							u[j-1] = u[j];
							u[j] = aux;
						}
					}
				}
			}

			function inserisciUtente() {

				var u = JSON.parse(localStorage.utenti);
				var nextpos = u.length;
				var o ={ nick: MyNomeUtente , score: MyPunteggio};
				alert("Dati inseriti correttamente");
				u[nextpos] = o;
				ordina(u);
				localStorage.utenti = JSON.stringify(u);
				return true;
			}
			
			function Rigioca() {
				window.location.href = 'game_Classifica.htm?name='+MyNomeUtente;
				return true;
			}



			</script>
		</head>
	<body style="background: url('paper.jpg');" onload="inizializzaClassificaUtenti()">

		<p>
		BRAVO! PREMI INVIA PER INVIARE IL TUO SCORE!
		</p>
		<form action="" method="post" name="registrazione" onSubmit="return inserisciUtente();"
		accept-charset="utf-8">
		<input type="submit" value="Invia">
		<input type="button" value="Vedi Classifica" onclick="stampaClassifica();">
		<input type="button" value="Reset Classifica" onclick="resetClassificaUtenti();">

		</form>

		<br>
		<button value="RIGIOCA" onclick="Rigioca()"> RIGIOCA </button>


		<hr/>
			<div id="vistaStorage"></div>
		<hr/>
	</body>
</html>
